# ETL + Snowflake Pipeline - Visual Architecture

## Complete System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           DATA SOURCES (INPUT)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  dataset_1.csv   â”‚  â”‚  dataset_2.csv   â”‚  â”‚  input_data.csv  â”‚     â”‚
â”‚  â”‚  (5 rows)        â”‚  â”‚  (5 rows)        â”‚  â”‚  (15 rows)       â”‚     â”‚
â”‚  â”‚                  â”‚  â”‚                  â”‚  â”‚                  â”‚     â”‚
â”‚  â”‚ emp_id           â”‚  â”‚ employee_id      â”‚  â”‚ emp_id           â”‚     â”‚
â”‚  â”‚ fname            â”‚  â”‚ first_name       â”‚  â”‚ first_name       â”‚     â”‚
â”‚  â”‚ lname            â”‚  â”‚ last_name        â”‚  â”‚ last_name        â”‚     â”‚
â”‚  â”‚ sex              â”‚  â”‚ gender           â”‚  â”‚ gender           â”‚     â”‚
â”‚  â”‚ birth_date       â”‚  â”‚ date_of_birth    â”‚  â”‚ dob              â”‚     â”‚
â”‚  â”‚ joining_date     â”‚  â”‚ hire_date        â”‚  â”‚ hire_date        â”‚     â”‚
â”‚  â”‚ annual_salary    â”‚  â”‚ salary           â”‚  â”‚ salary           â”‚     â”‚
â”‚  â”‚ dept             â”‚  â”‚ department       â”‚  â”‚ department       â”‚     â”‚
â”‚  â”‚ yrs_old          â”‚  â”‚ age              â”‚  â”‚ age              â”‚     â”‚
â”‚  â”‚ active_status    â”‚  â”‚ status           â”‚  â”‚ status           â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚           â†“                      â†“                      â†“              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                              â”‚
â”‚  â”‚sample_employee_  â”‚                                              â”‚
â”‚  â”‚data.csv          â”‚                                              â”‚
â”‚  â”‚(15 rows)         â”‚                                              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                              â”‚
â”‚           â†“                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    EXTRACTION & HEADER MAPPING                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€ Dataset 1 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                         â”‚
â”‚  â”‚ emp_id â†’ employee_id    â”‚                                         â”‚
â”‚  â”‚ fname â†’ first_name      â”‚                                         â”‚
â”‚  â”‚ lname â†’ last_name       â”‚                                         â”‚
â”‚  â”‚ sex â†’ gender            â”‚                                         â”‚
â”‚  â”‚ birth_date â†’ dob        â”‚                                         â”‚
â”‚  â”‚ joining_date â†’ hire_dateâ”‚                                         â”‚
â”‚  â”‚ annual_salary â†’ salary  â”‚                                         â”‚
â”‚  â”‚ dept â†’ department       â”‚                                         â”‚
â”‚  â”‚ yrs_old â†’ age           â”‚                                         â”‚
â”‚  â”‚ active_status â†’ status  â”‚                                         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                         â”‚
â”‚  â”Œâ”€ Dataset 2 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€ Dataset 3/4 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ 1:1 mapping (already    â”‚  â”‚ emp_id â†’ employee_id     â”‚        â”‚
â”‚  â”‚ has standard columns)   â”‚  â”‚ dob â†’ date_of_birth      â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ (mostly pass-through)    â”‚        â”‚
â”‚                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                     â”‚
â”‚  Result: 4 datasets with UNIFIED COLUMN NAMES                     â”‚
â”‚           â†“                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         DATA CONSOLIDATION                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  CONSOLIDATED_DATA (40 rows)                                â”‚       â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚
â”‚  â”‚  employee_id | first_name | last_name | gender | dob | ... â”‚       â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚       â”‚
â”‚  â”‚  101         | John       | Doe       | M      | ... â”‚       â”‚       â”‚
â”‚  â”‚  102         | Jane       | Smith     | F      | ... â”‚       â”‚       â”‚
â”‚  â”‚  201         | Diana      | Jones     | F      | ... â”‚       â”‚       â”‚
â”‚  â”‚  ...         | ...        | ...       | ...    | ... â”‚       â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       DATA TRANSFORMATION                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€ Step 1: Gender Normalization â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â”‚ M, male, MM â†’ M                             â”‚                       â”‚
â”‚  â”‚ F, female, ff â†’ F                           â”‚                       â”‚
â”‚  â”‚ 0, empty, null â†’ Unknown                    â”‚                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚  â”Œâ”€ Step 2: Date Formatting â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â”‚ All dates â†’ YYYY-MM-DD format              â”‚                       â”‚
â”‚  â”‚ 1990-01-15, 1/15/1990, etc. â†’ 1990-01-15  â”‚                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚  â”Œâ”€ Step 3: Error Handling â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â”‚ âœ“ Try-catch around all operations         â”‚                       â”‚
â”‚  â”‚ âœ“ Log detailed errors                     â”‚                       â”‚
â”‚  â”‚ âœ“ Auto-rectify common issues              â”‚                       â”‚
â”‚  â”‚ âœ“ Continue on partial failure             â”‚                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚  â”Œâ”€ Step 4: Data Cleaning â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â”‚ âœ“ Remove duplicates                       â”‚                       â”‚
â”‚  â”‚ âœ“ Fill missing values                     â”‚                       â”‚
â”‚  â”‚ âœ“ Validate data types                     â”‚                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚  â”Œâ”€ Step 5: Column Selection â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â”‚ Input: 10 columns                         â”‚                       â”‚
â”‚  â”‚ Output: 6 columns (selected)              â”‚                       â”‚
â”‚  â”‚   1. employee_id                          â”‚                       â”‚
â”‚  â”‚   2. first_name                           â”‚                       â”‚
â”‚  â”‚   3. last_name                            â”‚                       â”‚
â”‚  â”‚   4. gender                               â”‚                       â”‚
â”‚  â”‚   5. date_of_birth                        â”‚                       â”‚
â”‚  â”‚   6. salary                               â”‚                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    TRANSFORMED DATA (40 rows, 6 cols)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  employee_id | first_name | last_name | gender | date_of_birth | salary
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚  101         | John       | Doe       | M      | 1990-01-15    | 50000
â”‚  102         | Jane       | Smith     | F      | 1992-03-22    | 65000
â”‚  103         | Bob        | Johnson   | M      | 1988-06-10    | 55000
â”‚  ...
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   SPLIT OUTPUT      â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
            â†“                                     â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  CSV FILE        â”‚             â”‚  SNOWFLAKE UPLOAD    â”‚
    â”‚  (Local Storage) â”‚             â”‚  (Cloud Warehouse)   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“                                     â†“
    consolidated_employees.csv     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚  Connection Init          â”‚
                                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                                    â”‚  Account: xy12345.us-east  â”‚
                                    â”‚  User: etl_user            â”‚
                                    â”‚  Warehouse: COMPUTE_WH     â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                            â†“
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚  Database Creation        â”‚
                                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                                    â”‚  CREATE DATABASE ETL_DATA  â”‚
                                    â”‚  (auto-created)            â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                            â†“
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚  Schema Creation          â”‚
                                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                                    â”‚  CREATE SCHEMA EMPLOYEES   â”‚
                                    â”‚  (auto-created)            â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                            â†“
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚  Table Creation & Upload  â”‚
                                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                                    â”‚  CREATE TABLE             â”‚
                                    â”‚  CONSOLIDATED_EMPLOYEES   â”‚
                                    â”‚  (auto-created with data)  â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                            â†“
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚  Verification             â”‚
                                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                                    â”‚  SELECT COUNT(*) = 40      â”‚
                                    â”‚  Columns: 6                â”‚
                                    â”‚  Status: SUCCESS           â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                            â†“
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚  Upload Report Generated   â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Process Flow Diagram

```
START
  â†“
[Read Configuration]
  â”œâ”€ Snowflake credentials
  â””â”€ Transformation rules
  â†“
[Register 4 Data Sources]
  â”œâ”€ Source 1: dataset_1.csv
  â”œâ”€ Source 2: dataset_2.csv
  â”œâ”€ Source 3: input_data.csv
  â””â”€ Source 4: sample_employee_data.csv
  â†“
[EXTRACTION PHASE]
  â”œâ”€ Read CSV files
  â”œâ”€ Detect headers
  â”œâ”€ Apply mappings
  â””â”€ Load into DataFrames
  â†“
[CONSOLIDATION PHASE]
  â””â”€ Concatenate 4 DataFrames
     (40 rows total)
  â†“
[TRANSFORMATION PHASE]
  â”œâ”€ Normalize gender values
  â”œâ”€ Format dates (YYYY-MM-DD)
  â”œâ”€ Remove duplicates
  â”œâ”€ Fill missing values
  â””â”€ Select 6 final columns
  â†“
[ERROR HANDLING]
  â”œâ”€ Catch any errors
  â”œâ”€ Log details
  â”œâ”€ Auto-rectify if possible
  â””â”€ Continue or fail gracefully
  â†“
[SAVE TO CSV]
  â””â”€ output/consolidated_employees.csv
  â†“
[SNOWFLAKE UPLOAD]
  â”œâ”€ Connect to Snowflake
  â”œâ”€ Create database (ETL_DATA)
  â”œâ”€ Create schema (EMPLOYEES)
  â”œâ”€ Create table (CONSOLIDATED_EMPLOYEES)
  â””â”€ Upload data (40 rows)
  â†“
[VERIFICATION]
  â”œâ”€ Verify row count
  â”œâ”€ Verify columns
  â””â”€ Generate report
  â†“
[OUTPUT REPORTS]
  â”œâ”€ snowflake_upload_report.txt
  â”œâ”€ error_log.txt (if errors)
  â””â”€ Console output
  â†“
END (SUCCESS or FAILURE)
```

## Error Handling Flow

```
[TRY OPERATION]
  â†“
[SUCCESS?]
  â”œâ”€ YES â†’ Continue âœ“
  â””â”€ NO â†’ [ERROR CAUGHT]
           â†“
        [ERROR TYPE CHECK]
        â”œâ”€ Missing Column?
        â”‚   â””â”€ Skip column, log warning
        â”œâ”€ Invalid Date?
        â”‚   â””â”€ Set to NULL, log warning
        â”œâ”€ Gender Invalid?
        â”‚   â””â”€ Normalize to Unknown
        â”œâ”€ Connection Error?
        â”‚   â””â”€ Retry or fail gracefully
        â””â”€ Unknown Error?
            â””â”€ Log details, fail operation
           â†“
        [RECOVERY ATTEMPT]
        â”œâ”€ Auto-fix if possible
        â””â”€ Log action taken
           â†“
        [Continue or Abort?]
        â”œâ”€ Recoverable â†’ Continue
        â””â”€ Critical â†’ Abort & report
```

## Data Quality Checks

```
[INPUT DATA]
  â†“
[DATA VALIDATION CHECKS]
â”œâ”€ Row count: Present?
â”œâ”€ Column count: Expected?
â”œâ”€ Header names: Recognized?
â”œâ”€ Data types: Valid?
â”œâ”€ Gender values: M/F/0/empty/null?
â”œâ”€ Dates: Parseable format?
â”œâ”€ Duplicates: Present?
â””â”€ Missing values: Where?
  â†“
[QUALITY METRICS]
â”œâ”€ Total rows: 40
â”œâ”€ Rows processed: 40
â”œâ”€ Rows with errors: 0-2
â”œâ”€ Rows skipped: 0
â”œâ”€ Completion rate: 100% (or close)
â””â”€ Data integrity: PASS/WARN/FAIL
  â†“
[OUTPUT]
```

## Directory Structure

```
etl_pipeline/
â”‚
â”œâ”€â”€ ğŸ“‚ data/                          â† INPUT FILES
â”‚   â”œâ”€â”€ dataset_1.csv
â”‚   â”œâ”€â”€ dataset_2.csv
â”‚   â”œâ”€â”€ input_data.csv
â”‚   â””â”€â”€ sample_employee_data.csv
â”‚
â”œâ”€â”€ ğŸ“‚ output/                        â† OUTPUT FILES
â”‚   â”œâ”€â”€ consolidated_employees.csv
â”‚   â”œâ”€â”€ snowflake_upload_report.txt
â”‚   â””â”€â”€ error_log.txt
â”‚
â”œâ”€â”€ ğŸ“‚ venv/                          â† VIRTUAL ENVIRONMENT
â”‚   â””â”€â”€ (Python packages)
â”‚
â”œâ”€â”€ ğŸ etl_pipeline.py               â† Single-source ETL
â”œâ”€â”€ ğŸ multi_source_etl.py           â† Multi-source ETL
â”œâ”€â”€ ğŸ robust_etl.py                 â† Error handling
â”œâ”€â”€ ğŸ snowflake_integration.py      â† Snowflake connector
â”‚
â”œâ”€â”€ ğŸƒ complete_pipeline.py          â† MAIN RUNNER
â”œâ”€â”€ ğŸƒ run_four_sources.py           â† 4-source runner
â”œâ”€â”€ ğŸƒ run_robust_pipeline.py        â† Robust runner
â”‚
â”œâ”€â”€ âš™ï¸ snowflake_config.json         â† YOUR CREDENTIALS
â”œâ”€â”€ âš™ï¸ snowflake_config_template.json
â”œâ”€â”€ âš™ï¸ config.yaml
â”œâ”€â”€ âš™ï¸ requirements.txt
â”‚
â””â”€â”€ ğŸ“– DOCUMENTATION
    â”œâ”€â”€ README.md
    â”œâ”€â”€ QUICKSTART.md
    â”œâ”€â”€ SOLUTION_SUMMARY.md
    â”œâ”€â”€ SNOWFLAKE_GUIDE.md
    â”œâ”€â”€ MULTI_SOURCE_GUIDE.md
    â””â”€â”€ ARCHITECTURE.md (this file)
```

## Snowflake Object Hierarchy

```
Snowflake Account (xy12345.us-east-1)
â”‚
â””â”€â”€ Database: ETL_DATA
    â”‚
    â””â”€â”€ Schema: EMPLOYEES
        â”‚
        â””â”€â”€ Table: CONSOLIDATED_EMPLOYEES
            â”‚
            â”œâ”€â”€ Column 1: employee_id (NUMBER)
            â”œâ”€â”€ Column 2: first_name (VARCHAR)
            â”œâ”€â”€ Column 3: last_name (VARCHAR)
            â”œâ”€â”€ Column 4: gender (VARCHAR)
            â”œâ”€â”€ Column 5: date_of_birth (DATE)
            â””â”€â”€ Column 6: salary (NUMBER)
            â”‚
            â””â”€â”€ Data: 40 rows
```

---

**This visual architecture shows how your complete ETL + Snowflake pipeline works end-to-end!** ğŸ‰
